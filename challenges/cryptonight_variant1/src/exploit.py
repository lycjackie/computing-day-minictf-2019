from pwn import *
import pycryptonight

def main():
    p = remote("ctf.pwn.sg", 1502)

    question = p.recvline_contains("?")
    question = question.replace("?", "").strip()
    log.info("Got question: %s" % question)
    question = question.decode("hex")

    result = pycryptonight.cn_slow_hash(question, 1).encode("hex")
    log.info("Replying with %s" % result)

    p.sendline(result)

    flag = p.recvline()
    log.success(flag)


if __name__ == "__main__":
    main()
